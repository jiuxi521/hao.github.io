---
title: 2024-10-23
createTime: 2024/10/24 20:01:16
permalink: /article/ont10soq/
---

1. [MVCC](note/Database/关系型数据库/MySQL/MVCC.md)
2. [传播属性](note/Database/关系型数据库/MySQL/传播属性.md)
# Mysql默认RR，大厂为啥要改成RC
1. 提高并发度
	1. RR会添加间隙锁，形成Next-Key锁，降低锁并发
2. 减少死锁发生
	1. RR常用的Next-Key锁相较RC常用的[记录锁](note/Database/关系型数据库/MySQL/记录锁.md)，锁颗粒度变大，更容易发生死锁

## 单例bean和单例模式的区别
1. 单例bean是指IOC容器中类的不同beanId的实例对象只有一个；单例模式是指JVM上的类对象只有一个
2. 单例bean适用于需要共享或复用对象实例的场景；如：数据库连接池、线程池；单例模式适用于确保全局唯一的场景；如：日志管理器对象、全局配置对象

# JDK与CgLib的区别
1. JDK要求被增强类**必须实现接口**；CgLib支持**直接继承**被增强类
2. JDK代理要求被代理类必须实现接口，代理类实现接口，同时继承了Proxy（保存了InterceptorHandler h属性）,调用h的intercept方法进行调用;
3. Cglib无需接口，代理类**继承**被代理类，代理类(保存MethodInterceptor h属性)重写待增强方法，调用h的invoke方法进行调用

# Spring事务失效的场景
1. 方法内的自调用；没有过切面，事务方法没有增强
	1. 将调用方法拆分到另一个Bean
	2. 借助IOC容器获取代理实例，调用事务方法
	3. 自己注入自己，但需添加@Lazy注解
	4. 在方法中使用`AopContext.currentProxy()`获取当前类的代理类，同时支持代理暴露`@EnableAspectJAutoProxy(exposeProxy = true)`
2. 事务方法被private或final修饰，无法继承或实现
3. 数据库连接对象Connection没有被统一管理，事务使用的不是同一个连接对象
4. 